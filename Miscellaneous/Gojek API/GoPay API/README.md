GoPay node.js SDK for payments REST API
=========


![David](https://img.shields.io/david/rharasim/gopay-nodejs.svg)
![GitHub](https://img.shields.io/github/license/rharasim/gopay-nodejs.svg)
![GitHub code size in bytes](https://img.shields.io/github/languages/code-size/rharasim/gopay-nodejs.svg)
![npm](https://img.shields.io/npm/dt/gopay-nodejs.svg)

<p align="center">
  <img src="https://doc.gopay.com/images/logo.png">
</p>

Please visit https://doc.gopay.com/en/ for more informations.

## Installation

You can install via npm

  `npm install gopay-nodejs`

## Basic usage



    const gopay = require('gopay-nodejs');
    
Initialization is done through class GoPay. This class accepts three parameters. First your Client ID as string, second Client secret as string and third is optional boolean value for sandbox (true) or live (false) mode (default is true).  

    const gp = new gopay.GoPay("ClientID", "ClientSecret", true);
    
After initialization you can use all methods listed below. Every method accepts and returns data according to official [GoPay documentation](https://doc.gopay.com/en/).

### Example

    const gopay = require('gopay-nodejs');
    
    const gp = new gopay.GoPay("ClientID", "ClientSecret", true);
    const data = {
      "target": {
                "type":"ACCOUNT",
                "goid":"8123456789"
              },
      "amount":"10000",
      "currency":"CZK",
      "order_number":"001",
      "items": [{
                "type":"ITEM", 
                "name":"obuv",
                "product_url":"https://www.eshop.cz/boty/lodicky", 
                "ean":1234567890123,
                "amount":10000,
                "count":1,
                "vat_rate":21
                }],
      "callback":{
                "return_url":"http://www.eshop.cz/return",
                "notification_url":"http://www.eshop.cz/notify"
              },
    }
    
    gp.createPayment(data).then(payment => {
      console.log(payment)
    })
    
    
## Get token

Function `getToken()` accepts one optional string parameter called **scope**. Default value is `"payment-all"`. You can find all accepting values in docs: [scope](https://doc.gopay.com/en/#scope). Function returns token as string.
  
    gp.getToken().then(token => {
      console.log(token)
    }

## Create payment

Function `createPayment(JSON_DATA)` accepts one required **json** parameter. You can find all informations about required **json** in docs: [payment](https://doc.gopay.com/en/#standard-payment). Function returns **json** described in [docs: payment](https://doc.gopay.com/en/#standard-payment)

    gp.createPayment(JSON_DATA).then(payment => {
      console.log(payment)
    }
    
## Payment status

Function `getStatus(PAYMENT_ID)` accepts one required string parameter called **payment ID** (payment ID is generated by GoPay). Function returns **json** described in [docs: payment status](https://doc.gopay.com/en/#status-of-the-payment)

    gp.getStatus(PAYMENT_ID).then(status => {
      console.log(status)
    }

## Void authorization

Function `voidAuthorization(PAYMENT_ID)` accepts one required string parameter called **payment ID** (payment ID is generated by GoPay). Function returns **json** described in [docs: void auth](https://doc.gopay.com/en/#cancellation-of-pre-authorization)

    gp.voidAuthorization(PAYMENT_ID).then(info => {
      console.log(info)
    }
    
## Capture authorization

Function `captureAuthorization(PAYMENT_ID)` accepts one required string parameter called **payment ID** (payment ID is generated by GoPay). Function returns **json** described in [docs: capture auth](https://doc.gopay.com/en/#charge-of-pre-authorization)

    gp.captureAuthorization(PAYMENT_ID).then(info => {
      console.log(info)
    }
    
## Partial authorization

Function `partialAuthorization(PAYMENT_ID, JSON_DATA)` accepts two required parameters. First is string called **payment ID** (payment ID is generated by GoPay) and second is json described in docs: [json](https://doc.gopay.com/en/#partial-charge-of-pre-authorized-payment). Function returns **json** described in [docs: partian auth](https://doc.gopay.com/en/#partial-charge-of-pre-authorized-payment)

    gp.partialAuthorization(PAYMENT_ID, JSON_DATA).then(info => {
      console.log(info)
    }
    
## Create recurrence

Function `createRecurrence(PAYMENT_ID, JSON_DATA)` accepts two required parameters. First is string called **payment ID** (payment ID is generated by GoPay) and second is json described in docs: [json](https://doc.gopay.com/en/?lang=shell#recurring-on-demand). Function returns **json** described in [docs: recurring on demand](https://doc.gopay.com/en/?lang=shell#recurring-on-demand)

    gp.createRecurrence(PAYMENT_ID, JSON_DATA).then(info => {
      console.log(info)
    }
    
## Void recurrence

Function `voidRecurrence(PAYMENT_ID)` accepts one required string parameter called **payment ID** (payment ID is generated by GoPay). Function returns **json** described in [docs:void recurrence](https://doc.gopay.com/en/?lang=shell#cancellation-of-recurring)

    gp.voidRecurrence(PAYMENT_ID).then(info => {
      console.log(info)
    }
    
## Refund payment
  
Function `refundPayment(PAYMENT_ID, AMOUNT)` accepts two required parameters. First is string called **payment ID** (payment ID is generated by GoPay) and second is number, number represents **amount in cents** (long > 0) more in docs: [refund](https://doc.gopay.com/en/?lang=shell#refundation). Function returns **json** described in [docs:refund](https://doc.gopay.com/en/?lang=shell#refundation)

    gp.refundPayment(PAYMENT_ID, AMOUNT).then(info => {
      console.log(info)
    }
